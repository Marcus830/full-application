<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inmate Management</title>
    <style>
        /* Sidebar styling */
        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            width: 15%;
            background-color: #ada1a1;
            height: 100vh; /* Full viewport height */
            position: fixed;
            overflow: auto;
        }

        ul li a {
            display: block;
            color: #000;
            text-align: center;
            padding: 12px;
            text-decoration: none;
            font-weight: bold;
        }

        ul li a:hover {
            background-color: #888;
            color: white;
        }
        table{
            margin-left: 18%;
            padding: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .search-bar{
            margin-left: 18%;
            padding: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        #searchInput{
            width: 75%; /* Full-width */
            padding: 12px 20px 12px 40px; /* Add some padding */
            border: 1px solid #0e0d0d; /* Add a black border */
            background-position: 10px 12px; /* Position the search icon */
            background-image: url('/css/searchicon.png'); /* Add a search icon to input */
            border-radius: 2%;
        }
        table{
            width: 75%; /* Full-width */
            border: 2px solid #ddd; /* Add a grey border */
            font-size: 18px; /* Increase font-size */
        }
        th, td {
            text-align: left; /* Left-align text */
            padding: 12px; /* Add padding */
        }
        tr {
            /* Add a bottom border to all table rows */
            border-bottom: 1px solid #ddd;
        }
        tr.header, tr:hover {
            /* Add a grey background color to the table header and on hover */
            background-color: #f1f1f1;
        }
    </style>
    <script>
         function navigateTo(page) {
            // Replace these links with actual pages in your system
            const pages = {
                home: "Homepage.html",
                staff: "staff_management.html",
                incidents: "incident_reporting.html"
            };
            window.location.assign(pages[page]);
        }

        /*
        const apiUrl = 'http://localhost:27016/inmate';

        async function fetchInmates() {
            try {
                const response = await fetch(apiUrl); // Fetch data from the backend
                if (!response.ok) throw new Error('Failed to fetch');
                const inmates = await response.json(); // Parse the JSON response
                populateTable(inmates); // Populate the table with data
            } catch (error) {
                console.error('Error fetching inmates:', error);
            }
        }

        function populateTable(inmates) {
            const tableBody = document.getElementById('inmateTableBody');
            tableBody.innerHTML = ''; // Clear existing table rows

            inmates.forEach(inmate => {
                const row = `<tr>
                    <td>${inmate._id}</td>
                    <td>${inmate.name}</td>
                    <td>${inmate.crime}</td>
                    <td>${inmate.sentenceDuration}</td>
                    <td>${new Date(inmate.arrestDate).toLocaleDateString()}</td>
                </tr>`;
                tableBody.innerHTML += row;
            });
        }
            fetchInmates(); // Call the function when the page loads
        function searchInmates() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#inmateTableBody tr');

            rows.forEach(row => {
                const name = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                row.style.display = name.includes(searchInput) ? '' : 'none';
            });
        }
            */
        
        async function fetchInmates() {
            try {
                const response = await fetch('http://localhost:3000/Inmate'); // Case-sensitive match
                const inmates = await response.json();
                console.log(inmates); // Populate your table with this data
            } catch (error) {
                console.error('Error fetching inmates:', error);
            }
        }

        fetchInmates();

        function searchInmates() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#inmateTableBody tr');

            rows.forEach(row => {
                const name = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                row.style.display = name.includes(searchInput) ? '' : 'none';
            });
        }
    </script>
</head>
<body>
    <header style="background-color: #333; color: white; padding: 10px; text-align: center;">
        <h1>Inmate Management System</h1>
        <p>Managing Inmates</p>
    </header>
    
    <!-- Sidebar Navigation -->
    <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">Calendar</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">About</a></li>
    </ul>
    <div class="search-bar">
        <input type="text" placeholder="Search inmates..." id="searchInput" />
        <button onclick="fetchInmates();">Search</button>
    </div>
    
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Crime</th>
                <th>Sentence Duration</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="inmateTableBody">
            <!-- Rows dynamically populated via JavaScript -->
        </tbody>
    </table>
    
    <button onclick="openAddInmateForm()">Add New Inmate</button>
    
    <form id="addInmateForm" onsubmit="addInmate(event)">
        <input type="text" id="name" placeholder="Name" required />
        <input type="text" id="crime" placeholder="Crime" required />
        <input type="number" id="sentenceDuration" placeholder="Sentence Duration (years)" required />
        <input type="date" id="arrestDate" required />
        <button type="submit">Add Inmate</button>
    </form>
    

</body>
</html>